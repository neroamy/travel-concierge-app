Restarted application in 3,242ms.
I/flutter (14710): 🔐 Auth initialized - Logged in: true, User: nero1
I/flutter (14710): 🧪 Running API connection tests...
I/flutter (14710): 🧪 === API CONNECTION TESTS ===
I/flutter (14710): 📡 Testing server connections...
I/flutter (14710): ❌ CONNECTION - main_api: error
I/flutter (14710):    URL: http://192.168.1.7:8001/api/health
I/flutter (14710):    Error: TimeoutException after 0:00:05.000000: Future not completed
I/flutter (14710):
I/flutter (14710): ❌ CONNECTION - chat_api: 404
I/flutter (14710):    URL: http://192.168.1.7:8002/health
I/flutter (14710):
I/flutter (14710): 🔐 Testing authentication endpoints...
I/flutter (14710): ✅ AUTHENTICATION - login_endpoint: 400
I/flutter (14710):    URL: http://192.168.1.7:8001/api/auth/login/
I/flutter (14710):
I/flutter (14710): ✅ AUTHENTICATION - verify_endpoint: 401
I/flutter (14710):    URL: http://192.168.1.7:8001/api/auth/verify/
I/flutter (14710):
I/flutter (14710): 👤 Testing profile endpoints...
I/flutter (14710): ✅ PROFILE - profile_endpoint: 404
I/flutter (14710):    URL: http://192.168.1.7:8001/api/profile
I/flutter (14710):
I/flutter (14710): 🔑 Testing with sample credentials...
I/flutter (14710): ❌ SAMPLE LOGIN - sample_login: 401
I/flutter (14710):    URL: http://192.168.1.7:8001/api/auth/login/
I/flutter (14710):    Response: {"success":false,"message":"Invalid username or password","error_code":"INVALID_CREDENTIALS"}
I/flutter (14710):
I/flutter (14710): ✅ === TEST COMPLETED ===
I/flutter (14710): 📡 Token verification status: 401
I/flutter (14710): ❌ Token verification failed, clearing auth data
I/flutter (14710): 🗑️ Auth data cleared
I/flutter (14710): ! Session expired, navigating to login
I/AssistStructure(14710): Flattened final assist data: 468 bytes, containing 1 windows, 3 views
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring on
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring on
I/AssistStructure(14710): Flattened final assist data: 468 bytes, containing 1 windows, 3 views
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring off
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring on
I/flutter (14710): 🚀 Attempting login for username: nero1
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring off
I/flutter (14710): 📡 Login response status: 200
I/flutter (14710): 📡 Login response body: {"success":true,"message":"Login successful","token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX3V1aWQiOiIzOTQwYjc1MS01YWRjLTExZjAtYWJlMS0wMjY1MDFkZjAzNGEiLCJ1c2VybmFtZSI6Im5lcm8xIiwiZW1haWwiOiJuZXJvQGdtYWlsLmNvbSIsImlhdCI6MTc1MjAyNzgzNSwiZXhwIjoxNzUyMTE0MjM1fQ.vn3vuotFvzaa73oZFc0qB6oc9dFC-Y_U__ElwSpj05A","user":{"user_uuid":"3940b751-5adc-11f0-abe1-026501df034a","username":"nero1","email":"nero@gmail.com","full_name":"neroTran","avatar_url":"https://example.com/avatars/alan_love.jpg","address":"Ha Noi, Viet Nam","interests":["Travel","Photography","Food"]}}
I/flutter (14710): 💾 Auth data stored successfully
I/flutter (14710): ✅ Profile updated from auth data: nero1
I/flutter (14710): 🔄 Profile synced with auth data
I/flutter (14710): 🔄 User info updated for chat: neroTran
I/flutter (14710): 🔄 GlobalChatService synced with auth data
I/flutter (14710): ✅ Login successful for user: nero1
I/flutter (14710): ✅ Profile loaded from storage: nero1
I/flutter (14710): Session created successfully: session_1752027836170
I/flutter (14710): ✅ Global chat session initialized successfully
I/flutter (14710): 🚀 Navigating to AI Chat from search field tap
I/flutter (14710): 🎨 Building chat messages. Count: 0, isTyping: false
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring on
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring off
I/AssistStructure(14710): Flattened final assist data: 480 bytes, containing 1 windows, 3 views
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring on
I/flutter (14710): 💬 Sending message: "xin chào"
I/flutter (14710): 🚀 Sending message via global service: "xin chào"
I/flutter (14710): 🌐 GlobalChatService: Starting sendMessage for: "xin chào"
I/flutter (14710): 👤 Adding user message to history
I/flutter (14710): 💬 Added message to global chat history. Total messages: 1
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027843672
I/flutter (14710):    - Text: xin chào
I/flutter (14710):    - Author: user
I/flutter (14710):    - IsFromUser: true
I/flutter (14710):    - Timestamp: 2025-07-09 11:24:03.672235
I/flutter (14710): 📋 Updated local messages count: 1
I/flutter (14710): 👤 User message or system message, keeping typing indicator
I/flutter (14710): 🔄 Starting stream from travel service...
I/flutter (14710): 🎨 Building chat messages. Count: 1, isTyping: true
I/flutter (14710): 💬 Building message bubble for index: 0 - Author: user - IsUser: true
I/flutter (14710): 💬 Building typing indicator at index: 1
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring off
I/flutter (14710): 📡 Received stream result:
I/flutter (14710):    - Author: root_agent
I/flutter (14710):    - Text length: 32
I/flutter (14710):    - Text preview: What can I help you with today?
I/flutter (14710): 🤖 Processing AI response part...
I/flutter (14710): 🎯 Processing accumulated AI response:
I/flutter (14710):    - Total text length: 32
I/flutter (14710):    - Total function responses: 0
I/flutter (14710): 📨 Created final AI message:
I/flutter (14710):    - ID: 1752027846250
I/flutter (14710):    - Author: root_agent
I/flutter (14710):    - Text length: 32
I/flutter (14710):    - Function responses: 0
I/flutter (14710): 💬 Added message to global chat history. Total messages: 2
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027846250
I/flutter (14710):    - Text: What can I help you with today?
I/flutter (14710):    - Author: root_agent
I/flutter (14710):    - IsFromUser: false
I/flutter (14710):    - Timestamp: 2025-07-09 11:24:06.251001
I/flutter (14710): 📋 Updated local messages count: 2
I/flutter (14710): 🤖 AI response received, stopping typing indicator
I/flutter (14710): 🔍 Analyzing response for locations and itinerary...
I/flutter (14710):    - Response text length: 32
I/flutter (14710):    - Function responses count: 0
I/flutter (14710):    - Response preview: What can I help you with today?
I/flutter (14710): 📄 FULL RESPONSE:
I/flutter (14710): What can I help you with today?
I/flutter (14710): 📄 END FULL RESPONSE
I/flutter (14710): 🔍 Checking itinerary pattern in text...
I/flutter (14710):    - Has day pattern: false
I/flutter (14710):    - Has time slots: false
I/flutter (14710):    - Has multiple days: false
I/flutter (14710):    - Has alternative day pattern: false
I/flutter (14710):    - Final itinerary pattern result: false
I/flutter (14710):    - Has itinerary pattern: false
I/flutter (14710): 🔍 Checking location list pattern in text...
I/flutter (14710):    - Has numbered list: false
I/flutter (14710):    - Has address: false
I/flutter (14710):    - Has rating: false
I/flutter (14710):    - Has multiple entries: false
I/flutter (14710):    - Has alternative pattern: false
I/flutter (14710):    - Final location list pattern result: false
I/flutter (14710):    - Has location list pattern: false
I/flutter (14710):    - Has map_url in text: false
I/flutter (14710):    - Has map_tool function: false
I/flutter (14710): ❓ No specific patterns detected, trying general analysis...
I/flutter (14710): 🔍 Checking itinerary pattern in text...
I/flutter (14710):    - Has day pattern: false
I/flutter (14710):    - Has time slots: false
I/flutter (14710):    - Has multiple days: false
I/flutter (14710):    - Has alternative day pattern: false
I/flutter (14710):    - Final itinerary pattern result: false
I/flutter (14710): 🔍 Checking location list pattern in text...
I/flutter (14710):    - Has numbered list: false
I/flutter (14710):    - Has address: false
I/flutter (14710):    - Has rating: false
I/flutter (14710):    - Has multiple entries: false
I/flutter (14710):    - Has alternative pattern: false
I/flutter (14710):    - Final location list pattern result: false
I/flutter (14710):    - General response type: AIResponseType.question
I/flutter (14710): ❓ AI is asking a question
I/flutter (14710): 🏁 Analysis completed:
I/flutter (14710):    - Detected locations: 0
I/flutter (14710):    - Detected itinerary days: 0
I/flutter (14710): ✅ GlobalChatService: sendMessage completed
I/flutter (14710): ✅ Global service sendMessage completed
I/flutter (14710): 🎨 Building chat messages. Count: 2, isTyping: false
I/flutter (14710): 💬 Building message bubble for index: 0 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 1 - Author: root_agent - IsUser: false
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring on
I/flutter (14710): 💬 Sending message: "gợi ý plan roadtrip từ Saitama tới Kamikochi"
I/flutter (14710): 🚀 Sending message via global service: "gợi ý plan roadtrip từ Saitama tới Kamikochi"
I/flutter (14710): 🌐 GlobalChatService: Starting sendMessage for: "gợi ý plan roadtrip từ Saitama tới Kamikochi"
I/flutter (14710): 👤 Adding user message to history
I/flutter (14710): 💬 Added message to global chat history. Total messages: 3
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027887598
I/flutter (14710):    - Text: gợi ý plan roadtrip từ Saitama tới Kamikochi
I/flutter (14710):    - Author: user
I/flutter (14710):    - IsFromUser: true
I/flutter (14710):    - Timestamp: 2025-07-09 11:24:47.598567
I/flutter (14710): 📋 Updated local messages count: 3
I/flutter (14710): 👤 User message or system message, keeping typing indicator
I/flutter (14710): 🔄 Starting stream from travel service...
I/flutter (14710): 🎨 Building chat messages. Count: 3, isTyping: true
I/flutter (14710): 💬 Building message bubble for index: 0 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 1 - Author: root_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 2 - Author: user - IsUser: true
I/flutter (14710): 💬 Building typing indicator at index: 3
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring off
I/flutter (14710): 📡 Received stream result:
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 395
I/flutter (14710):    - Text preview: Okay, I can help you with inspiration for a road trip from Saitama to Kamikochi. Since you like moun...
I/flutter (14710): 🤖 Processing AI response part...
I/flutter (14710): 🎯 Processing accumulated AI response:
I/flutter (14710):    - Total text length: 395
I/flutter (14710):    - Total function responses: 0
I/flutter (14710): 📨 Created final AI message:
I/flutter (14710):    - ID: 1752027889966
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 395
I/flutter (14710):    - Function responses: 0
I/flutter (14710): 💬 Added message to global chat history. Total messages: 4
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027889966
I/flutter (14710):    - Text: Okay, I can help you with inspiration for a road trip from Saitama to Kamikochi. Since you like mountains and beautiful scenery, Kamikochi is an excellent choice!
I/flutter (14710):
I/flutter (14710): To make sure I tailor the suggestions to your taste, can you confirm if you have any specific interests along the way? For example, are you interested in historical sites, onsen (hot springs), or perhaps some unique local cuisine?
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - IsFromUser: false
I/flutter (14710):    - Timestamp: 2025-07-09 11:24:49.966500
I/flutter (14710): 📋 Updated local messages count: 4
I/flutter (14710): 🤖 AI response received, stopping typing indicator
I/flutter (14710): 🔍 Analyzing response for locations and itinerary...
I/flutter (14710):    - Response text length: 395
I/flutter (14710):    - Function responses count: 0
I/flutter (14710):    - Response preview: Okay, I can help you with inspiration for a road trip from Saitama to Kamikochi. Since you like mountains and beautiful scenery, Kamikochi is an excellent choice!
I/flutter (14710):
I/flutter (14710): To make sure I tailor the suggestion...
I/flutter (14710): 📄 FULL RESPONSE:
I/flutter (14710): Okay, I can help you with inspiration for a road trip from Saitama to Kamikochi. Since you like mountains and beautiful scenery, Kamikochi is an excellent choice!
I/flutter (14710):
I/flutter (14710): To make sure I tailor the suggestions to your taste, can you confirm if you have any specific interests along the way? For example, are you interested in historical sites, onsen (hot springs), or perhaps some unique local cuisine?
I/flutter (14710): 📄 END FULL RESPONSE
I/flutter (14710): 🔍 Checking itinerary pattern in text...
I/flutter (14710):    - Has day pattern: false
I/flutter (14710):    - Has time slots: false
I/flutter (14710):    - Has multiple days: false
I/flutter (14710):    - Has alternative day pattern: false
I/flutter (14710):    - Final itinerary pattern result: false
I/flutter (14710):    - Has itinerary pattern: false
I/flutter (14710): 🔍 Checking location list pattern in text...
I/flutter (14710):    - Has numbered list: false
I/flutter (14710):    - Has address: false
I/flutter (14710):    - Has rating: false
I/flutter (14710):    - Has multiple entries: false
I/flutter (14710):    - Has alternative pattern: false
I/flutter (14710):    - Final location list pattern result: false
I/flutter (14710):    - Has location list pattern: false
I/flutter (14710):    - Has map_url in text: false
I/flutter (14710):    - Has map_tool function: false
I/flutter (14710): ❓ No specific patterns detected, trying general analysis...
I/flutter (14710): 🔍 Checking itinerary pattern in text...
I/flutter (14710):    - Has day pattern: false
I/flutter (14710):    - Has time slots: false
I/flutter (14710):    - Has multiple days: false
I/flutter (14710):    - Has alternative day pattern: false
I/flutter (14710):    - Final itinerary pattern result: false
I/flutter (14710): 🔍 Checking location list pattern in text...
I/flutter (14710):    - Has numbered list: false
I/flutter (14710):    - Has address: false
I/flutter (14710):    - Has rating: false
I/flutter (14710):    - Has multiple entries: false
I/flutter (14710):    - Has alternative pattern: false
I/flutter (14710):    - Final location list pattern result: false
I/flutter (14710):    - General response type: AIResponseType.question
I/flutter (14710): ❓ AI is asking a question
I/flutter (14710): 🏁 Analysis completed:
I/flutter (14710):    - Detected locations: 0
I/flutter (14710):    - Detected itinerary days: 0
I/flutter (14710): ✅ GlobalChatService: sendMessage completed
I/flutter (14710): ✅ Global service sendMessage completed
I/flutter (14710): 🎨 Building chat messages. Count: 4, isTyping: false
I/flutter (14710): 💬 Building message bubble for index: 0 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 1 - Author: root_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 2 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 3 - Author: inspiration_agent - IsUser: false
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring on
I/flutter (14710): 💬 Sending message: "hãy phản hồi bằng tiếng việt"
I/flutter (14710): 🚀 Sending message via global service: "hãy phản hồi bằng tiếng việt"
I/flutter (14710): 🌐 GlobalChatService: Starting sendMessage for: "hãy phản hồi bằng tiếng việt"
I/flutter (14710): 👤 Adding user message to history
I/flutter (14710): 💬 Added message to global chat history. Total messages: 5
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027913362
I/flutter (14710):    - Text: hãy phản hồi bằng tiếng việt
I/flutter (14710):    - Author: user
I/flutter (14710):    - IsFromUser: true
I/flutter (14710):    - Timestamp: 2025-07-09 11:25:13.362473
I/flutter (14710): 📋 Updated local messages count: 5
I/flutter (14710): 👤 User message or system message, keeping typing indicator
I/flutter (14710): 🔄 Starting stream from travel service...
I/flutter (14710): 🎨 Building chat messages. Count: 5, isTyping: true
I/flutter (14710): 💬 Building message bubble for index: 0 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 1 - Author: root_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 2 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 3 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 4 - Author: user - IsUser: true
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring off
I/flutter (14710): 💬 Building message bubble for index: 4 - Author: user - IsUser: true
I/flutter (14710): 💬 Building typing indicator at index: 5
I/flutter (14710): 💬 Building message bubble for index: 1 - Author: root_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 0 - Author: user - IsUser: true
I/flutter (14710): 📡 Received stream result:
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 391
I/flutter (14710):    - Text preview: Tuyệt vời! Kamikochi là một lựa chọn tuyệt vời cho chuyến đi từ Saitama. Nơi đây nổi tiếng với núi n...
I/flutter (14710): 🤖 Processing AI response part...
I/flutter (14710): 🎯 Processing accumulated AI response:
I/flutter (14710):    - Total text length: 391
I/flutter (14710):    - Total function responses: 0
I/flutter (14710): 📨 Created final AI message:
I/flutter (14710):    - ID: 1752027914951
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 391
I/flutter (14710):    - Function responses: 0
I/flutter (14710): 💬 Added message to global chat history. Total messages: 6
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027914951
I/flutter (14710):    - Text: Tuyệt vời! Kamikochi là một lựa chọn tuyệt vời cho chuyến đi từ Saitama. Nơi đây nổi tiếng với núi non hùng vĩ và phong cảnh tuyệt đẹp, rất phù hợp với sở thích của bạn.
I/flutter (14710):
I/flutter (14710): Để tôi có thể gợi ý những điểm dừng chân phù hợp nhất trên đường đi, bạn có muốn ghé thăm những địa điểm cụ thể nào không? Ví dụ như các di tích lịch sử, suối nước nóng onsen, hay thưởng thức ẩm thực địa phương độc đáo?
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - IsFromUser: false
I/flutter (14710):    - Timestamp: 2025-07-09 11:25:14.951131
I/flutter (14710): 📋 Updated local messages count: 6
I/flutter (14710): 🤖 AI response received, stopping typing indicator
I/flutter (14710): 🔍 Analyzing response for locations and itinerary...
I/flutter (14710):    - Response text length: 391
I/flutter (14710):    - Function responses count: 0
I/flutter (14710):    - Response preview: Tuyệt vời! Kamikochi là một lựa chọn tuyệt vời cho chuyến đi từ Saitama. Nơi đây nổi tiếng với núi non hùng vĩ và phong cảnh tuyệt đẹp, rất phù hợp với sở thích của bạn.
I/flutter (14710):
I/flutter (14710): Để tôi có thể gợi ý những điể...
I/flutter (14710): 📄 FULL RESPONSE:
I/flutter (14710): Tuyệt vời! Kamikochi là một lựa chọn tuyệt vời cho chuyến đi từ Saitama. Nơi đây nổi tiếng với núi non hùng vĩ và phong cảnh tuyệt đẹp, rất phù hợp với sở thích của bạn.
I/flutter (14710):
I/flutter (14710): Để tôi có thể gợi ý những điểm dừng chân phù hợp nhất trên đường đi, bạn có muốn ghé thăm những địa điểm cụ thể nào không? Ví dụ như các di tích lịch sử, suối nước nóng onsen, hay thưởng thức ẩm thực địa phương độc đáo?
I/flutter (14710): 📄 END FULL RESPONSE
I/flutter (14710): 🔍 Checking itinerary pattern in text...
I/flutter (14710):    - Has day pattern: false
I/flutter (14710):    - Has time slots: false
I/flutter (14710):    - Has multiple days: false
I/flutter (14710):    - Has alternative day pattern: false
I/flutter (14710):    - Final itinerary pattern result: false
I/flutter (14710):    - Has itinerary pattern: false
I/flutter (14710): 🔍 Checking location list pattern in text...
I/flutter (14710):    - Has numbered list: false
I/flutter (14710):    - Has address: false
I/flutter (14710):    - Has rating: false
I/flutter (14710):    - Has multiple entries: false
I/flutter (14710):    - Has alternative pattern: false
I/flutter (14710):    - Final location list pattern result: false
I/flutter (14710):    - Has location list pattern: false
I/flutter (14710):    - Has map_url in text: false
I/flutter (14710):    - Has map_tool function: false
I/flutter (14710): ❓ No specific patterns detected, trying general analysis...
I/flutter (14710): 🔍 Checking itinerary pattern in text...
I/flutter (14710):    - Has day pattern: false
I/flutter (14710):    - Has time slots: false
I/flutter (14710):    - Has multiple days: false
I/flutter (14710):    - Has alternative day pattern: false
I/flutter (14710):    - Final itinerary pattern result: false
I/flutter (14710): 🔍 Checking location list pattern in text...
I/flutter (14710):    - Has numbered list: false
I/flutter (14710):    - Has address: false
I/flutter (14710):    - Has rating: false
I/flutter (14710):    - Has multiple entries: false
I/flutter (14710):    - Has alternative pattern: false
I/flutter (14710):    - Final location list pattern result: false
I/flutter (14710):    - General response type: AIResponseType.question
I/flutter (14710): ❓ AI is asking a question
I/flutter (14710): 🏁 Analysis completed:
I/flutter (14710):    - Detected locations: 0
I/flutter (14710):    - Detected itinerary days: 0
I/flutter (14710): ✅ GlobalChatService: sendMessage completed
I/flutter (14710): ✅ Global service sendMessage completed
I/flutter (14710): 🎨 Building chat messages. Count: 6, isTyping: false
I/flutter (14710): 💬 Building message bubble for index: 0 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 1 - Author: root_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 2 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 3 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 4 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 5 - Author: inspiration_agent - IsUser: false
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring on
I/flutter (14710): 💬 Sending message: "yeah,tôi thích onsen và món ăn địa phương"
I/flutter (14710): 🚀 Sending message via global service: "yeah,tôi thích onsen và món ăn địa phương"
I/flutter (14710): 🌐 GlobalChatService: Starting sendMessage for: "yeah,tôi thích onsen và món ăn địa phương"
I/flutter (14710): 👤 Adding user message to history
I/flutter (14710): 💬 Added message to global chat history. Total messages: 7
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027941532
I/flutter (14710):    - Text: yeah,tôi thích onsen và món ăn địa phương
I/flutter (14710):    - Author: user
I/flutter (14710):    - IsFromUser: true
I/flutter (14710):    - Timestamp: 2025-07-09 11:25:41.532746
I/flutter (14710): 📋 Updated local messages count: 7
I/flutter (14710): 👤 User message or system message, keeping typing indicator
I/flutter (14710): 🔄 Starting stream from travel service...
I/flutter (14710): 🎨 Building chat messages. Count: 7, isTyping: true
I/flutter (14710): 💬 Building message bubble for index: 3 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 4 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 5 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 6 - Author: user - IsUser: true
I/flutter (14710): 💬 Building typing indicator at index: 7
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring off
I/flutter (14710): 💬 Building message bubble for index: 3 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 📡 Received stream result:
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 713
I/flutter (14710):    - Text preview: Tuyệt vời! Vậy thì trên đường đi từ Saitama đến Kamikochi, chúng ta có thể khám phá một vài điểm dừn...
I/flutter (14710): 🤖 Processing AI response part...
I/flutter (14710): 🎯 Processing accumulated AI response:
I/flutter (14710):    - Total text length: 713
I/flutter (14710):    - Total function responses: 0
I/flutter (14710): 📨 Created final AI message:
I/flutter (14710):    - ID: 1752027944237
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 713
I/flutter (14710):    - Function responses: 0
I/flutter (14710): 💬 Added message to global chat history. Total messages: 8
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027944237
I/flutter (14710):    - Text: Tuyệt vời! Vậy thì trên đường đi từ Saitama đến Kamikochi, chúng ta có thể khám phá một vài điểm dừng chân nổi tiếng với onsen và ẩm thực địa phương.
I/flutter (14710):
I/flutter (14710): Để tôi gợi ý một vài điểm đến tiềm năng nhé:
I/flutter (14710):
I/flutter (14710): 1.  **Kusatsu Onsen:** Một trong những khu onsen nổi tiếng nhất Nhật Bản, với nguồn nước nóng tự nhiên chất lượng cao và không khí thị trấn onsen truyền thống.
I/flutter (14710): 2.  **Takayama:** Thị trấn cổ kính với kiến trúc nhà gỗ đặc trưng, nổi tiếng với món thịt bò Hida và chợ sáng địa phương.
I/flutter (14710): 3.  **Shirakawa-go:** Ngôi làng cổ với những ngôi nhà mái tranh Gassho-zukuri độc đáo, được UNESCO công nhận là Di sản Thế giới.
I/flutter (14710):
I/flutter (14710): Bạn thấy hứng thú với địa điểm nào nhất không? Hoặc bạn có muốn tôi gợi ý thêm các lựa chọn khác không?
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - IsFromUser: false
I/flutter (14710):    - Timestamp: 2025-07-09 11:25:44.237440
I/flutter (14710): 📋 Updated local messages count: 8
I/flutter (14710): 🤖 AI response received, stopping typing indicator
I/flutter (14710): 🔍 Analyzing response for locations and itinerary...
I/flutter (14710):    - Response text length: 713
I/flutter (14710):    - Function responses count: 0
I/flutter (14710):    - Response preview: Tuyệt vời! Vậy thì trên đường đi từ Saitama đến Kamikochi, chúng ta có thể khám phá một vài điểm dừng chân nổi tiếng với onsen và ẩm thực địa phương.
I/flutter (14710):
I/flutter (14710): Để tôi gợi ý một vài điểm đến tiềm năng nhé:
I/flutter (14710):
I/flutter (14710): 1. ...
I/flutter (14710): 📄 FULL RESPONSE:
I/flutter (14710): Tuyệt vời! Vậy thì trên đường đi từ Saitama đến Kamikochi, chúng ta có thể khám phá một vài điểm dừng chân nổi tiếng với onsen và ẩm thực địa phương.
I/flutter (14710):
I/flutter (14710): Để tôi gợi ý một vài điểm đến tiềm năng nhé:
I/flutter (14710):
I/flutter (14710): 1.  **Kusatsu Onsen:** Một trong những khu onsen nổi tiếng nhất Nhật Bản, với nguồn nước nóng tự nhiên chất lượng cao và không khí thị trấn onsen truyền thống.
I/flutter (14710): 2.  **Takayama:** Thị trấn cổ kính với kiến trúc nhà gỗ đặc trưng, nổi tiếng với món thịt bò Hida và chợ sáng địa phương.
I/flutter (14710): 3.  **Shirakawa-go:** Ngôi làng cổ với những ngôi nhà mái tranh Gassho-zukuri độc đáo, được UNESCO công nhận là Di sản Thế giới.
I/flutter (14710):
I/flutter (14710): Bạn thấy hứng thú với địa điểm nào nhất không? Hoặc bạn có muốn tôi gợi ý thêm các lựa chọn khác không?
I/flutter (14710): 📄 END FULL RESPONSE
I/flutter (14710): 🔍 Checking itinerary pattern in text...
I/flutter (14710):    - Has day pattern: false
I/flutter (14710):    - Has time slots: false
I/flutter (14710):    - Has multiple days: false
I/flutter (14710):    - Has alternative day pattern: false
I/flutter (14710):    - Final itinerary pattern result: false
I/flutter (14710):    - Has itinerary pattern: false
I/flutter (14710): 🔍 Checking location list pattern in text...
I/flutter (14710):    - Has numbered list: true
I/flutter (14710):    - Has address: false
I/flutter (14710):    - Has rating: false
I/flutter (14710):    - Has multiple entries: true
I/flutter (14710):    - Has alternative pattern: false
I/flutter (14710):    - Final location list pattern result: false
I/flutter (14710):    - Has location list pattern: false
I/flutter (14710):    - Has map_url in text: false
I/flutter (14710):    - Has map_tool function: false
I/flutter (14710): ❓ No specific patterns detected, trying general analysis...
I/flutter (14710): 🔍 Checking itinerary pattern in text...
I/flutter (14710):    - Has day pattern: false
I/flutter (14710):    - Has time slots: false
I/flutter (14710):    - Has multiple days: false
I/flutter (14710):    - Has alternative day pattern: false
I/flutter (14710):    - Final itinerary pattern result: false
I/flutter (14710): 🔍 Checking location list pattern in text...
I/flutter (14710):    - Has numbered list: true
I/flutter (14710):    - Has address: false
I/flutter (14710):    - Has rating: false
I/flutter (14710):    - Has multiple entries: true
I/flutter (14710):    - Has alternative pattern: false
I/flutter (14710):    - Final location list pattern result: false
I/flutter (14710):    - General response type: AIResponseType.question
I/flutter (14710): ❓ AI is asking a question
I/flutter (14710): 🏁 Analysis completed:
I/flutter (14710):    - Detected locations: 0
I/flutter (14710):    - Detected itinerary days: 0
I/flutter (14710): ✅ GlobalChatService: sendMessage completed
I/flutter (14710): ✅ Global service sendMessage completed
I/flutter (14710): 🎨 Building chat messages. Count: 8, isTyping: false
I/flutter (14710): 💬 Building message bubble for index: 3 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 4 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 5 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 6 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 7 - Author: inspiration_agent - IsUser: false
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring on
I/flutter (14710): 💬 Sending message: "tôi thích Takayama"
I/flutter (14710): 🚀 Sending message via global service: "tôi thích Takayama"
I/flutter (14710): 🌐 GlobalChatService: Starting sendMessage for: "tôi thích Takayama"
I/flutter (14710): 👤 Adding user message to history
I/flutter (14710): 💬 Added message to global chat history. Total messages: 9
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027966834
I/flutter (14710):    - Text: tôi thích Takayama
I/flutter (14710):    - Author: user
I/flutter (14710):    - IsFromUser: true
I/flutter (14710):    - Timestamp: 2025-07-09 11:26:06.834575
I/flutter (14710): 📋 Updated local messages count: 9
I/flutter (14710): 👤 User message or system message, keeping typing indicator
I/flutter (14710): 🔄 Starting stream from travel service...
I/flutter (14710): 🎨 Building chat messages. Count: 9, isTyping: true
I/flutter (14710): 💬 Building message bubble for index: 5 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 6 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 7 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 8 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 8 - Author: user - IsUser: true
I/flutter (14710): 💬 Building typing indicator at index: 9
D/InputConnectionAdaptor(14710): The input method toggled cursor monitoring off
I/flutter (14710): 💬 Building message bubble for index: 6 - Author: user - IsUser: true
I/flutter (14710): 📡 Received stream result:
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 198
I/flutter (14710):    - Text preview: Tuyệt vời! Takayama là một lựa chọn tuyệt vời. Đây là một thị trấn cổ kính với rất nhiều điều thú vị...
I/flutter (14710): 🤖 Processing AI response part...
I/flutter (14710): 📡 Received stream result:
I/flutter (14710):    - Author: system
I/flutter (14710):    - Text length: 42
I/flutter (14710):    - Text preview: 📍 Found activities and points of interest
I/flutter (14710): ! Skipping non-AI message: system
I/flutter (14710): 📡 Received stream result:
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 1672
I/flutter (14710):    - Text preview: Dưới đây là một vài điểm tham quan và hoạt động nổi bật ở Takayama mà bạn có thể thích:
I/flutter (14710):
I/flutter (14710): *   **Phố c...
I/flutter (14710): 🤖 Processing AI response part...
I/flutter (14710): 📡 Received stream result:
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 2645
I/flutter (14710):    - Text preview: Tuyệt vời! Dưới đây là thông tin chi tiết hơn về các địa điểm du lịch nổi tiếng ở Takayama, bao gồm ...
I/flutter (14710): 🤖 Processing AI response part...
I/flutter (14710): 🎯 Processing accumulated AI response:
I/flutter (14710):    - Total text length: 4519
I/flutter (14710):    - Total function responses: 0
I/flutter (14710): 📨 Created final AI message:
I/flutter (14710):    - ID: 1752027988187
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - Text length: 4519
I/flutter (14710):    - Function responses: 0
I/flutter (14710): 💬 Added message to global chat history. Total messages: 10
I/flutter (14710): 📨 Received callback message:
I/flutter (14710):    - ID: 1752027988187
I/flutter (14710):    - Text: Tuyệt vời! Takayama là một lựa chọn tuyệt vời. Đây là một thị trấn cổ kính với rất nhiều điều thú vị để khám phá.
I/flutter (14710):
I/flutter (14710): Bây giờ, để tôi gợi ý một vài hoạt động và điểm tham quan nổi bật ở Takayama nhé:
I/flutter (14710):
I/flutter (14710):
I/flutter (14710):
I/flutter (14710): Dưới đây là một vài điểm tham quan và hoạt động nổi bật ở Takayama mà bạn có thể thích:
I/flutter (14710):
I/flutter (14710): *   **Phố cổ Takayama:** Khu phố cổ được bảo tồn với những ngôi nhà truyền thống, cửa hàng và xưởng sản xuất rượu sake từ thời Edo.
I/flutter (14710):     *   Địa chỉ: Takayama, Gifu Prefecture, Japan
I/flutter (14710):     *   Đánh giá: 4.5 sao
I/flutter (14710):     *   Điểm nổi bật: Kiến trúc truyền thống, mua sắm quà lưu niệm, thưởng thức rượu sake địa phương.
I/flutter (14710): *   **Làng dân gian Hida:** Bảo tàng ngoài trời trưng bày những ngôi nhà nông thôn và các công trình kiến trúc truyền thống từ vùng Hida.
I/flutter (14710):     *   Địa chỉ: 1-590 Kamiokamotomachi, Takayama,
I/flutter (14710):    - Author: inspiration_agent
I/flutter (14710):    - IsFromUser: false
I/flutter (14710):    - Timestamp: 2025-07-09 11:26:28.187300
I/flutter (14710): 📋 Updated local messages count: 10
I/flutter (14710): 🤖 AI response received, stopping typing indicator
I/flutter (14710): 🔍 Analyzing response for locations and itinerary...
I/flutter (14710):    - Response text length: 4519
I/flutter (14710):    - Function responses count: 0
I/flutter (14710):    - Response preview: Tuyệt vời! Takayama là một lựa chọn tuyệt vời. Đây là một thị trấn cổ kính với rất nhiều điều thú vị để khám phá.
I/flutter (14710):
I/flutter (14710): Bây giờ, để tôi gợi ý một vài hoạt động và điểm tham quan nổi bật ở Takayama nhé:
I/flutter (14710):
I/flutter (14710):
I/flutter (14710):
I/flutter (14710): ...
I/flutter (14710): 📄 FULL RESPONSE:
I/flutter (14710): Tuyệt vời! Takayama là một lựa chọn tuyệt vời. Đây là một thị trấn cổ kính với rất nhiều điều thú vị để khám phá.
I/flutter (14710):
I/flutter (14710): Bây giờ, để tôi gợi ý một vài hoạt động và điểm tham quan nổi bật ở Takayama nhé:
I/flutter (14710):
I/flutter (14710):
I/flutter (14710):
I/flutter (14710): Dưới đây là một vài điểm tham quan và hoạt động nổi bật ở Takayama mà bạn có thể thích:
I/flutter (14710):
I/flutter (14710): *   **Phố cổ Takayama:** Khu phố cổ được bảo tồn với những ngôi nhà truyền thống, cửa hàng và xưởng sản xuất rượu sake từ thời Edo.
I/flutter (14710):     *   Địa chỉ: Takayama, Gifu Prefecture, Japan
I/flutter (14710):     *   Đánh giá: 4.5 sao
I/flutter (14710):     *   Điểm nổi bật: Kiến trúc truyền thống, mua sắm quà lưu niệm, thưởng thức rượu sake địa phương.
I/flutter (14710): *   **Làng dân gian Hida:** Bảo tàng ngoài trời trưng bày những ngôi nhà nông thôn và các công trình kiến trúc truyền thống từ vùng Hida.
I/flutter (14710):     *   Địa chỉ: 1-590 Kamiokamotomachi, Takayama, Gifu 506-00
I/flutter (14710): 📄 END FULL RESPONSE
I/flutter (14710): 🔍 Checking itinerary pattern in text...
I/flutter (14710):    - Has day pattern: false
I/flutter (14710):    - Has time slots: true
I/flutter (14710):    - Has multiple days: false
I/flutter (14710):    - Has alternative day pattern: false
I/flutter (14710):    - Final itinerary pattern result: false
I/flutter (14710):    - Has itinerary pattern: false
I/flutter (14710): 🔍 Checking location list pattern in text...
I/flutter (14710):    - Has numbered list: false
I/flutter (14710):    - Has address: true
I/flutter (14710):    - Has rating: true
I/flutter (14710):    - Has multiple entries: false
I/flutter (14710):    - Has alternative pattern: false
I/flutter (14710):    - Final location list pattern result: false
I/flutter (14710):    - Has location list pattern: false
I/flutter (14710):    - Has map_url in text: true
I/flutter (14710):    - Has map_tool function: false
I/flutter (14710): 📍 Processing location response...
I/flutter (14710): 🔍 Starting location extraction...
I/flutter (14710): 🔄 Starting to parse AI response...
I/flutter (14710): 📝 Response text length: 4519
I/flutter (14710): 📝 Response preview: Tuyệt vời! Takayama là một lựa chọn tuyệt vời. Đây là một thị trấn cổ kính với rất nhiều điều thú vị để khám phá.
I/flutter (14710):
I/flutter (14710): Bây giờ, để tôi gợi ý một vài hoạt động và điểm tham quan nổi bật ở Takayama nhé:
I/flutter (14710):
I/flutter (14710):
I/flutter (14710):
I/flutter (14710): Dưới đây là một vài điểm tham quan và hoạt động nổi bật ở Takayama mà bạn có thể thích:
I/flutter (14710):
I/flutter (14710): *   **Phố cổ Takayama:** Khu phố cổ được bảo tồn với những ngôi nhà truyền thống, cửa hàng và xưởng sản xuất rượu sake từ thời Edo.
I/flutter (14710):     *   Địa chỉ: Takayama, Gifu Prefecture, Japan
I/flutter (14710):     *   Đánh giá: 4.5 sao
I/flutter (14710):    ...
I/flutter (14710): 🔍 Found 0 potential place matches with pattern
I/flutter (14710): 🏁 Parsing completed. Total places found: 0
I/flutter (14710): 📍 Extracted 0 places from text response
I/flutter (14710): 🔗 Found 0 Google Maps URLs in response
I/flutter (14710): 📍 Extracted 0 places from map URLs in text
I/flutter (14710): 🏁 Total places extracted: 0
I/flutter (14710): 🎯 Detected 0 locations from response
I/flutter (14710): 🏁 Analysis completed:
I/flutter (14710):    - Detected locations: 0
I/flutter (14710):    - Detected itinerary days: 0
I/flutter (14710): ✅ GlobalChatService: sendMessage completed
I/flutter (14710): ✅ Global service sendMessage completed
I/flutter (14710): 🎨 Building chat messages. Count: 10, isTyping: false
I/flutter (14710): 💬 Building message bubble for index: 6 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 7 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 8 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 9 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 8 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 7 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 8 - Author: user - IsUser: true
I/flutter (14710): 💬 Building message bubble for index: 7 - Author: inspiration_agent - IsUser: false
I/flutter (14710): 💬 Building message bubble for index: 6 - Author: user - IsUser: true
